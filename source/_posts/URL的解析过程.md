---
title: URL的解析过程
date: 2020-03-28 20:32:41
categories: 
- 理论归纳
tags:
- 计算机网络
---

# URL的解析过程

## 用户输入URL

现在的浏览器较为智能，如chrome在输入过程中会根据用户输入的字符串在历史记录中查询对应url并显示在地址栏下方，以便用户补全url。

## 查找DNS

浏览器会先根据域名查找浏览器自身DNS缓存。

可以通过[chrome://net-internals/#dns](chrome://net-internals/#dns)产看与清除chromeDNS缓存。

## 查找本地缓存

如果在浏览器自身缓存中未找到，浏览器会进行系统调用查询本机host文件。

## 查找路由器缓存

若在本机host中没有找到目标域名ip地址则会将查询请求发送给路由器查询路由器DNS。

## 查找运营商的解析（递归查询）

若路由器中依旧没有目域名ip地址，会查询运营商的本地域名服务器（本地域名服务器会在第一次访问url时缓存它）。

## 查询根域名服务器

若本地域名服务器依旧没有对应目标ip，本地域名服务器将代替用户机向根域名服务器发出查询请求报文。

## 迭代查询

若根域名服务器中依旧没有对应ip则回返回给本地域名服务器下一个要查询的根域名服务器地址，由本地域名服务器继续查询。

## 查询结束

若查询成功将会把目标ip返回给用户机，若查询失败本地服务器会向用户机发出失败响应，表示无法查询到所需ip地址。

## 建立TCP连接

进行用户机与服务的三次握手建立TCP连接。

## 发送HTTP或HTTPS请求

用户机向服务器发器一个请求信息，若试用https协议会在传输层对其进行加密（应用层依旧是明文的http请求）。

## 回复响应报文

服务器将接收请求报文，使用私钥解密（https）后将响应发挥用户机。

## 页面渲染

浏览器收到响应报文后将其解析渲染后展现给用户。