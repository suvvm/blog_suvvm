---
title: 程序、进程、线程与协程
date: 2020-04-10 15:57:45
categories: 
- 理论归纳
tags:
- OS
---

#  程序、进程、线程与协程

## 程序

- 程序是一组计算机可识别的指令的有序集合

## 进程

### 定义

- 进程是程序在动态数据集合上的一次运行过程，是程序的实体
- 进程是操作系统资源分配的基本单位
- 进程是处理机调度的基本单位，进程调度时要陷入内核态，切换内容保存在内存中，调度时要切换全局目录、内核栈、硬件上下文

### 特征

- 动态性：进程是程序的一次动态的执行过程（基本特征）
- 并发性：多个进程可以同时存在在内存中，并且能与其他进程并发执行
- 独立性：进程是可以独立运行、独立独立获取资源、独立接受调度的基本单位
- 异步性：进程是按异步的方式运行的，按各自独立不可预知的速度向前推进

## 线程

### 定义

- 线程是操作系统处理机调度的最小单位
- 线程是进程的一部分，代表了一条顺序执行流

#### 用户级线程

- 不依赖操作系统核心，内核无法感知到线程的存在
- 用户级线程在用户态运行，创建调度与销毁都由应用程序完成
- 处理机调度依旧由进程作为基本单位，进程被阻塞是所有的线程都将被阻塞
- 不需要操作系统支持，只需实现线程库即可使用用户级线程

#### 内核级线程

- 由操作系统内核管理线程，并向应用程序提供API接口
- 由内核维护进程和内核级线程的上下文
- 内核级线程的调度需要陷入内核态
- 一个内核级线程被阻塞不会影响到其他内核级线程的运行
- 由于线程共享进程资源，所以切换效率即使要陷入内核态也比切换进程效率高，切换内容保存在内核栈中，只需切换内核栈与硬件上下文

### 特性

- 同一进程下的线程共享进程地址空间与资源
- 线程有自己的栈与栈指针
- 有状态与状态转换
- 线程可以创建、撤销另一个线程，程序开始是是单线程的方式运行的
- 一个线程只能属于一个进程，一个进程可以拥有多个线程

## 协程

### 定义

- 协程是一种用户态的轻量级线程
- 协程是线程的一部分，一个线程可以有多个协程

### 特性

- 无需操作系统支持，只需实现协程库便可以使用协程
- 协程调度用用户应用程序实现，无需陷入内核态，切换效率高
- 协程是串行的，一个线程内的协程同一时间只能有一个运行
- 由于协程是串行的，所以无需实现锁，也不存在同时读写变量的冲突