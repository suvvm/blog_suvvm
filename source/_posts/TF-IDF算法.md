---
title: TF-IDF算法
date: 2021-02-02 15:25:09
categories: 
- 理论归纳
tags:
- 机器学习
- NLP
mathjax: true
---

# TF-IDF算法

## 一、TF-IDF概念

​	词频-逆文档频率（Term Frequency-Inverse Document Frequency，TD-IDF）是一种用于文本挖掘与信息检索的常用自然语言处理技术。

​	TF-IDF属于统计方法，用于评估一个word对于一个文件集或语料库中的其中一份文件的重要程度（提取文档关键词）。word的重要性随着其在文件中出现的次数成正比增加，但同时会随着其在语料库中出现的频率成反比下降。
$$
TFIDF = TF(词频) \times IDF（逆文档频率）
$$


## 二、TF-IDF主要思想

​	TD-IDF的主要思想是如果某个词语或短语在一片文章中出现的的频率TF高，并且在其他文章中很少出现（IDF低），则认为该词或短语有很好的类别区分能力，适合用来分类。

​	例如，我们用狗屁不通文章生成器以“郭一”为主题生成一篇文章。

```
	这是不可避免的。我们高兴地发现，郭一是一个好消息。高汀说过一句著名的话，习惯，我们每个人或多或少都是它的奴隶。这不禁令我深思。别林斯基曾经提到过，好的书籍是最贵重的珍宝。这句话语虽然很短，但令我浮想联翩。 这些事实也清楚地表明我们应该郭一。一般来讲，我们都必须务必慎重地考虑考虑。那么，郭沫若说过一句著名的话，形成天才的决定因素应该是勤奋。这句话把我们带到了一个新的维度去思考这个问题： 罗曼·罗兰曾经提到过，只有把抱怨环境的心情，化为上进的力量，才是成功的保证。我希望诸位也能好好地体会这句话。 郭一的发生，到底需要如何做到，不郭一的发生，又会如何产生。本人也是经过了深思熟虑，在每个日日夜夜思考这个问题。我强烈建议郭一，既然如此，我希望大家本着知无不言、言无不尽、言者无罪、闻者足戒的精神，认真看待郭一这个重要问题。 
	总而言之，整个社会应该密切关注郭一这个问题。 
  莎士比亚曾经提到过，时间会刺破青春表面的彩饰，会在美人的额上掘深沟浅槽；会吃掉稀世之珍！天生丽质，什么都逃不过他那横扫的镰刀。这句话语虽然很短，但令我浮想联翩。 从这个角度来看，既然如此，我们要统一思想，统一步骤地，为了根本解决郭一的问题而努力。我们都知道，只要有意义，那么就必须慎重考虑。这些事实也清楚地表明我们应该郭一。我们一般认为，抓住了问题的关键，其他一切就会迎刃而解。问题的关键究竟为何？尽管不同问题人们有着不同观点，但是郭一正愈来愈成为人们的共识。可是，即使是这样，郭一的出现仍然代表了一定的意义。 
  郭一似乎是一种巧合，但如果我们从一个更大的角度看待问题，这似乎是一种不可避免的事实。鲁迅曾经说过，单是说不行，要紧的是做。这不禁令我深思。随着社会的发展变化，对我个人而言，郭一不仅仅是一个重大的事件，还可能会改变我的人生。尽管不同问题人们有着不同观点，但是郭一正愈来愈成为人们的共识。总之，我认为，对我个人而言，郭一不仅仅是一个重大的事件，还可能会改变我的人生。郭一，到底应该如何实现。一般来说，首先，也许是最重要的是郭一。而这些并不是完全重要，更加重要的问题是，可是，即使是这样，郭一的出现仍然代表了一定的意义。要想清楚，郭一，到底是一种怎么样的存在。郭一因何而发生？首先，也许是最重要的是郭一。带着这些问题，我们来审视一下郭一。从这个角度来看，每个人都不得不面对这些问题。在面对这种问题时，歌德在不经意间这样说过，谁要游戏人生，他就一事无成，谁不能主宰自己，永远是一个奴隶。这句话语虽然很短，但令我浮想联翩。
```

​	我们很清楚，这篇文章中的主题是“郭一”，但若单靠词频提取，可能“的”“了”之类的词出现的频率更高，这时便要给它们一个惩罚，这就是TF-IDF的主要思想。

## 三、TF与IDF的计算

### 1、词频（TF）

​	词频指的是给定的一个词语在该文档中出现的频率。这个数字是对词数的归一化，以防止计算结果偏向词书多的长文件。
$$
TF_{i,j}=\frac{n_{i,j}}{n_{*,j}}
$$
​	其中$TF_{i,j}$表示词语i在文档j中出现的频率，$n_{i,j}$表示词语i在文档j中出现的次数，$n_{*,j}$表示文档j的总词数。

### 2、逆向文件频率（IDF）

​	逆向文件频率是一个词语普遍重要性的度量，某一特定词语的IDF可以由总文档数目处以包含该词语之文档的数目，再将其得到的商取对数获得。
$$
IDF_i = log(\frac{N+1}{N_i+1})
$$
​	其中$IDF_i$表示词语i在文档集中的逆文档频率，N表示文档集中的文档总数，$N_i$表示文档集中包含了词语I的文档数量。

## 四、算法实现

​	这里我使用了TF-IDF算法简单实现了一个[狗屁不通文章解码器](https://github.com/suvvm/BullshitDecoder)，通过TF-IDF算法确定文章主题并推测最初关键词。